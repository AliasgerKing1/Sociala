(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9564],{22610:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collections",function(){return r(13653)}])},65161:function(e,n,r){"use strict";r.d(n,{U:function(){return c},F:function(){return f}});var t=r(85893);function c(e){return(0,t.jsx)("div",{className:"justify-left flex flex-row gap-8",children:e.children})}var i=r(26042),s=r(69396),l=r(99534),o=r(67294),a=r(8336);function u(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}var d=r(31237),h=r(86563),f=(0,o.forwardRef)((function(e,n){var r,c=e.link,f=e.count,x=e.title,p=e.loading,m=(0,l.Z)(e,["link","count","title","loading"]),v=(0,o.useRef)(null),j=(0,d.Y)(n,v);if((0,o.useEffect)((function(){!0===m.selected&&null!==v.current&&v.current.getBoundingClientRect().bottom>0&&v.current.getBoundingClientRect().top<window.innerHeight&&v.current.scrollIntoView({block:"nearest",inline:"center"})}),[v,m.selected]),r=f,!Number.isInteger(r)||r<0)throw TypeError("Invalid Number ".concat(f,". Number must be a positive integer >= 0"));return(0,o.createElement)(!0===c?"a":"button",(0,s.Z)((0,i.Z)({ref:j},m),{className:(0,a.A)("px-12 py-4 rounded-8 h-32 shrink-0",!0===m.selected?"bg-black":"bg-white","text-16",!0===m.selected?"":"hover:bg-gray-100","focus-visible:ring-4 focus-visible:ring-blue-200/50","cursor-pointer select-none")}),(0,t.jsxs)("div",{className:"flex h-full flex-row items-center gap-x-8",children:[(0,t.jsx)("span",{className:!0===m.selected?"text-white":"text-black",children:x}),!0!==p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:(0,a.A)("h-16 w-[1px]",!0===m.selected?"bg-white":"bg-gray-200")}),(0,t.jsx)("span",{className:!0===m.selected?"text-white":"text-gray-200",children:u(f)})]}):null,!0===m.new&&(0,t.jsx)("span",{className:"ml-4 -mr-4 flex",children:(0,t.jsx)(h.C,{color:"green",selected:!0===m.selected,children:"New"})})]}))}))},31237:function(e,n,r){"use strict";r.d(n,{Y:function(){return c}});var t=r(67294);function c(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0,t.useCallback)((function(e){var r=!0,t=!1,c=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value;"function"===typeof l?l(e):l&&"object"===typeof l&&(l.current=e)}}catch(o){t=!0,c=o}finally{try{r||null==s.return||s.return()}finally{if(t)throw c}}}),n)}},75462:function(e,n,r){"use strict";r.d(n,{X:function(){return c}});var t=r(1299);function c(e){return(0,t.Z)("string"===typeof e?Date.parse(e):e,Date.now(),{addSuffix:!0}).replace(/minute/,"min").replace(/^1 day ago$/,"yesterday").replace(/about /,"").replace(/almost /,"")}},29613:function(e,n,r){"use strict";r.d(n,{Ad:function(){return m},W_:function(){return p},bX:function(){return x}});var t=r(47568),c=r(26042),i=r(69396),s=r(34051),l=r.n(s),o=r(88767),a=r(52816),u=r(79523),d=r(20506);function h(){return f.apply(this,arguments)}function f(){return(f=(0,t.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.r)(u._m.from("authenticated_user_collections_with_counts").select());case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){var e,n=null===(e=(0,u.aC)())||void 0===e?void 0:e.user();return(0,o.useQuery)((0,a.j)(["collections"]),h,{enabled:Boolean(n)})}function p(e,n){e.invalidateQueries((0,a.y)("collections")),e.refetchQueries((0,a.j)(["collections"]),{exact:!0}),e.setQueryData((0,a.j)(["collections"],n.id),(0,i.Z)((0,c.Z)({},n),{appsCount:0,appScreensCount:0}))}function m(e,n){e.refetchQueries((0,a.j)(["collections"]),{exact:!0}),e.invalidateQueries((0,a.j)(["collections"],n))}},24139:function(e,n,r){"use strict";r.d(n,{$:function(){return f}});var t=r(47568),c=r(34051),i=r.n(c),s=r(88767),l=r(66308),o=r(79523),a=r(20506),u=r(29613);function d(e){return h.apply(this,arguments)}function h(){return(h=(0,t.Z)(i().mark((function e(n){var r,t,c,s,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name,t=n.description,c=void 0===t?"":t,s=n.workspaceId,l=o._m.auth.user()){e.next=4;break}throw new Error("User is unauthenticated.");case 4:return e.next=6,(0,a.r)(o._m.from("collections").insert({name:r,workspaceId:s,description:null!==c&&void 0!==c?c:"",createdBy:l.id},{returning:"minimal"}).limit(1).single());case 6:return e.next=8,(0,a.r)(o._m.from("collections").select().match({workspaceId:s,createdBy:l.id}).order("createdAt",{ascending:!1}).limit(1).single());case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){var e=(0,s.useQueryClient)();return(0,s.useMutation)(d,{onSuccess:function(n){l.aX.track("Collection Created",{collection_id:n.id}),(0,u.W_)(e,n)}})}},78479:function(e,n,r){"use strict";r.d(n,{qx:function(){return c},Ij:function(){return o},Dl:function(){return a},eq:function(){return u}});var t=r(85893);function c(e){var n=e.children;return(0,t.jsx)("div",{className:"flex flex-col items-center gap-y-32 pb-64",children:n})}var i=r(41664),s=r.n(i),l=r(47562);function o(e){return(0,t.jsx)("div",{className:"flex w-[240px] flex-col items-stretch",children:"href"in e?(0,t.jsx)(s(),{passHref:!0,href:e.href,children:(0,t.jsx)(l.z,{large:!0,link:!0,children:e.children})}):(0,t.jsx)(l.z,{large:!0,onClick:e.onClick,children:e.children})})}function a(e){return(0,t.jsx)("p",{className:"w-[300px] text-center text-16 text-gray-200",children:e.children})}function u(e){return(0,t.jsx)("h2",{className:"text-24",children:e.children})}},13653:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return ee}});var t=r(10253),c=r(85893),i=r(67294),s=r(41664),l=r.n(s),o=r(75472),a=r.n(o),u=r(65161),d=r(82196),h=r(24415),f=r(78183),x=r(85435),p=r(75462),m=r(10166),v=r(38935),j=r(74862),g=r(76195),w=r(47568),y=r(26042),b=r(69396),N=r(34051),k=r.n(N),_=r(88767),C=r(96486),Z=r(52513),S=r(52816),I=r(79523),A=r(20506),E=["name","id","type"],Q=["name","id","updatedAt","createdAt"];function q(){return(q=(0,w.Z)(k().mark((function e(){var n,r;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I._m.auth.user()){e.next=3;break}throw new Z.Q;case 3:return e.next=5,(0,A.r)(I._m.from("workspaces").select("\n          ".concat(E.join(","),",\n          collections(").concat(Q.join(","),")\n        ")));case 5:return r=e.sent,e.abrupt("return",(0,C.sortBy)(r.map((function(e){var r;return"personal"===e.type?(0,b.Z)((0,y.Z)({},e),{name:null!==(r=n.user_metadata.full_name)&&void 0!==r?r:"Personal"}):e})),[function(e){return"team"===e.type?1:2},function(e){return e.name}]));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return(0,_.useQuery)((0,S.j)(["workspaces","collections","collection_apps","collection_app_screens","collection_app_sections"]),(function(){return function(){return q.apply(this,arguments)}()}),e)}var W=r(87536),B=r(11163),D=r(73955),M=r.n(D),X=r(47562),R=r(68448),T=r(23527),L=r(99773),O=r(31473),P=r(11428),$=r(8389),H=r(24139),z=r(78479);function U(e){var n,r,t=e.workspaceId,s=e.workspaceCollections,l=e.variant,o=(0,B.useRouter)(),a=(0,O.Ps)(),u=(0,m.dO)(),d=(0,P._C)(),f=(0,W.cI)({mode:"onSubmit",defaultValues:{name:"",description:""}}),x=(0,i.useMemo)((function(){return M()()}),[]),p=f.watch("name"),v=(0,i.useMemo)((function(){return!p}),[p]),j=(0,i.useState)(!1),g=j[0],N=j[1];(0,i.useEffect)((function(){g||f.reset()}),[g,f]);var _=(0,H.$)();return(0,c.jsxs)(R.Vq,{open:g,onOpenChange:function(e){return!_.isLoading&&N(e)},children:[(0,c.jsx)(R.hg,{onClick:function(e){var n=void 0!==u.membershipSubscriptionByWorkspace[t];s.length>=3&&!0!==n&&(e.preventDefault(),u.showPayWallModal({intent:"create_collection",workspaceId:t}))},children:function(){switch(l){case"default":return(0,c.jsx)(X.z,{icon:$.p,loading:_.isLoading,children:"New Collection"});case"floating":return(0,c.jsx)(L.a,{icon:$.p,children:"New Collection"});case"no_collections_yet_button":return(0,c.jsx)(z.Ij,{onClick:function(){return N(!0)},children:"Create a collection"})}}()}),(0,c.jsx)(R.$N,{children:"Create new collection"}),(0,c.jsx)(R.a7,{children:(0,c.jsxs)("form",{id:x,className:"flex grow flex-col gap-y-16 min-720:w-[448px]",onSubmit:f.handleSubmit(function(){var e=(0,w.Z)(k().mark((function e(n){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_.mutateAsync((0,b.Z)((0,y.Z)({},n),{workspaceId:t})).then((function(e){return o.push("/collections/".concat(e.id))})).catch(a.toastError);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),children:[(0,c.jsx)(T.Q,{title:"Name",error:null===(n=f.formState.errors.name)||void 0===n?void 0:n.message,children:(0,c.jsx)(h.n,(0,b.Z)((0,y.Z)({placeholder:"Enter name",autoFocus:!0},f.register("name",{required:"This field is required."})),{large:d<720}))}),(0,c.jsx)(T.Q,{title:"Description",error:null===(r=f.formState.errors.description)||void 0===r?void 0:r.message,children:(0,c.jsx)(h.n,(0,b.Z)((0,y.Z)({placeholder:"Enter description"},f.register("description")),{large:d<720}))})]})}),(0,c.jsxs)(R.RQ,{children:[(0,c.jsx)(R.lt,{disabled:v,loading:_.isLoading,form:x,children:"Create"}),(0,c.jsx)(R.$g,{disabled:_.isLoading})]})]})}function V(e){var n=e.onStartANewSearch;return(0,c.jsx)("div",{className:"flex grow items-center justify-center py-80",children:(0,c.jsxs)(z.qx,{children:[(0,c.jsx)(z.eq,{children:"No collections found"}),(0,c.jsx)(z.Dl,{children:"We couldn't find any collections matching your query. Try another query."}),n&&(0,c.jsx)(z.Ij,{onClick:n,children:"Start a new search"})]})})}function Y(e){return(0,c.jsx)("div",{className:"flex grow items-center justify-center py-80",children:(0,c.jsxs)(z.qx,{children:[(0,c.jsx)(z.eq,{children:"No collections yet"}),(0,c.jsx)(z.Dl,{children:"You haven't created any collections yet. When you do, it'll show up here."}),(0,c.jsx)(U,(0,b.Z)((0,y.Z)({},e),{variant:"no_collections_yet_button"}))]})})}function G(e){return(0,c.jsx)("td",{className:"text-left text-16 font-medium text-black",children:e.children})}var J=r(8336);function K(e){return(0,c.jsx)("th",{className:(0,J.A)("py-12 text-left text-16 font-medium text-gray-200",!0===e.fixedWidth&&"w-[280px]"),children:e.children})}function ee(){var e,n=(0,m.dO)(),r=F({enabled:!0===n.isAuthenticated}),s=(0,t.Z)((0,v.T)("last_browsed_collections_workspace",null),2),o=s[0],w=s[1],y=(0,i.useMemo)((function(){var e,n,t;return"string"===typeof o&&!0===(null===(e=r.data)||void 0===e?void 0:e.some((function(e){return e.id===o})))?o:null===(n=r.data)||void 0===n||null===(t=n[0])||void 0===t?void 0:t.id}),[o,r]),b=(0,i.useMemo)((function(){var n,t;return null!==(e=null===(t=null===(n=r.data)||void 0===n?void 0:n.find((function(e){return e.id===y})))||void 0===t?void 0:t.collections)&&void 0!==e?e:[]}),[r,y]),N=(0,i.useState)(""),k=N[0],_=N[1],C=(0,f.M)(k,a()(b,(function(e){return e.updatedAt}),["desc"]),[function(e){return e.name}]),Z=(0,i.useRef)(null),S=(0,i.useMemo)((function(){return b.length>0}),[b.length]);return!1===n.isAuthenticated?(0,c.jsx)("div",{className:"flex grow items-center justify-center py-40 px-12 min-720:px-24",children:(0,c.jsx)(j.g,{conversionIntent:"view_collections"})}):r.isFetched&&r.data?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g.F,{title:"Collections"}),(0,c.jsxs)("div",{className:"mt-32 flex flex-col pb-24",children:[(0,c.jsx)("h1",{className:"mb-16 px-12 py-8 text-40 font-bold min-720:px-24",children:"Collections"}),(S||r.data.length>1)&&(0,c.jsx)("div",{className:"scrollbar-none mb-24 flex h-32 overflow-x-auto",children:(0,c.jsx)("div",{className:"shrink-0 px-12 min-720:px-24",children:(0,c.jsx)(u.U,{children:r.data.map((function(e){var n=e.name,r=e.id,t=e.collections;return(0,c.jsx)(u.F,{count:t.length,title:n,selected:r===y,onClick:function(){return w(r)}},r)}))})})}),S||void 0===y?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"mb-16 flex flex-row gap-16 px-12 min-720:px-24",children:[(0,c.jsx)("div",{className:"grid grow",children:(0,c.jsx)(h.n,{icon:x.W,placeholder:"Find collections",onChange:function(e){return _(e.target.value)},ref:Z})}),(0,c.jsx)("div",{className:"hidden min-720:block",children:void 0!==y&&void 0!==b&&(0,c.jsx)(U,{variant:"default",workspaceId:y,workspaceCollections:b})})]}),0===C.length?(0,c.jsx)(V,{onStartANewSearch:function(){_(""),Z.current&&(Z.current.value="",Z.current.focus())}}):(0,c.jsxs)("table",{className:"w-full table-fixed",children:[(0,c.jsx)("thead",{className:"hidden min-720:table-header-group",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:"w-24"}),(0,c.jsx)(K,{children:"Collection name"}),(0,c.jsx)(K,{fixedWidth:!0,children:"Last modified"}),(0,c.jsx)(K,{fixedWidth:!0,children:"Created"}),(0,c.jsx)("th",{className:"w-24"})]})}),(0,c.jsx)("tbody",{children:C.map((function(e){var n=e.option,r=n.id,s=n.updatedAt,o=n.createdAt,a=(0,t.Z)(e.highlightedExtractions,1)[0];return(0,c.jsxs)(i.Fragment,{children:[(0,c.jsx)("tr",{className:"group hover:cursor-pointer min-720:hidden",children:(0,c.jsx)("td",{children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,children:(0,c.jsxs)("a",{className:"group flex h-[72px] flex-col justify-center px-12 hover:bg-gray-100",children:[(0,c.jsx)("span",{className:"group-hover:underline-black truncate text-ellipsis text-16 group-hover:underline group-hover:underline-offset-[3px]",children:a}),(0,c.jsx)("span",{className:"group-hover:underline-gray-200 text-14 text-gray-200 group-hover:underline group-hover:underline-offset-[3px]",children:(0,p.X)(s)})]})})})}),(0,c.jsxs)("tr",{className:"group hidden hover:cursor-pointer hover:bg-gray-100 min-720:table-row",children:[(0,c.jsx)("td",{className:"w-24",children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,passHref:!0,children:(0,c.jsx)("a",{className:"group-hover:underline-black block py-12 group-hover:underline group-hover:underline-offset-[3px]"})})}),(0,c.jsx)(G,{children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,children:(0,c.jsx)("a",{className:"group-hover:underline-black block py-12 group-hover:underline group-hover:underline-offset-[3px]",children:(0,c.jsxs)("div",{className:"flex flex-row",children:[(0,c.jsx)("span",{className:"truncate text-ellipsis",children:a}),(0,c.jsx)("div",{className:"w-16"})]})})})}),(0,c.jsx)(G,{children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,children:(0,c.jsx)("a",{className:"block truncate",children:(0,p.X)(s)})})}),(0,c.jsx)(G,{children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,children:(0,c.jsx)("a",{className:"block truncate",children:(0,p.X)(o)})})}),(0,c.jsx)("td",{className:"w-24",children:(0,c.jsx)(l(),{href:"/collections/".concat(r),shallow:!0,passHref:!0,children:(0,c.jsx)("a",{className:"group-hover:underline-black block py-12 group-hover:underline group-hover:underline-offset-[3px]"})})})]})]},r)}))})]}),(0,c.jsx)("div",{className:"min-720:hidden",children:void 0!==y&&void 0!==b&&(0,c.jsx)(U,{variant:"floating",workspaceId:y,workspaceCollections:b})})]}):(0,c.jsx)(Y,{workspaceId:y,workspaceCollections:b})]})]}):(0,c.jsx)("div",{className:"flex grow items-center justify-center",children:(0,c.jsx)(d.i,{})})}}},function(e){e.O(0,[8531,9774,2888,179],(function(){return n=22610,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
//# sourceMappingURL=collections-b454c122a5065c77.js.map